# HTTP-CACHE (http 缓存)

重用已获取的资源能够有效的提升网站与应用的性能。Web 缓存能够减少延迟与网络阻塞，进而减少显示某个资源所用的时间。借助 HTTP 缓存，Web 站点变得更具有响应性。

## 缓存预览

一个简单的缓存实例:

![一个简单的图例](./imgs/easy-example.webp)

浏览器首次请求 `app.js` 时，服务器会返回资源内容和相关头部，其中 `Cache-Control: max-age=120` 告诉浏览器说，这个资源的缓存有效期为 120 秒，从当前时间 `Date: Mon, 05 Mar 2018 08:00:00 GMT` 开始算起。浏览器收到资源后便将 `app.js` 及其相应头部存储在本地。

如果在 `05 Mar, 2018 08:02:00 GMT` 之前再次请求 `app.js` ，则浏览器会直接使用存储在本地的资源，而不用再次向服务器发起请求。

## 几个基本概念

* 命中：存有可以使用的缓存文件
* 过期：缓存数据超过设置的有效时间
* 验证：与服务器交互确认缓存是否有效
* 失效：缓存数据不在有效

如上面的示例

1. 当浏览器首次请求 `app.js`的时候，本地没有缓存，所以需要从服务器下载缓存文件。
2. 浏览器保存下载文件，并记录服务器设置过期时间
3. 第二次请求的时候发现本地有缓存，并且没有过期，可以直接使用缓存文件

## 代理

在网络请求中，代理是十分常见的一环，为了更高效的服务用户，代理通常也会缓存一些数据，而不是直接和服务器进行沟通

http 缓存`从大类上来区分有两种:

1. 强缓存
   强缓存的意思是缓存命中则不发起 `http` 请求直接使用本地缓存
2. 协商缓存
   协商缓存的意思是浏览器发起一个请求询问服务器该资源是否可以使用缓存文件，如果可以则使用本地缓存，如果过期则从新下载文件



